name: ä½¿ç”¨ Hugging Face SDK åˆ›å»º Player Space

on:
  workflow_dispatch:
    inputs:
      Token:
        description: 'Hugging Face Access Tokenï¼ˆéœ€è¦å†™æƒé™ï¼‰'
        required: true
        default: ''
      UserID:
        description: 'ä½ çš„ Hugging Face ç”¨æˆ·å'
        required: true
        default: ''
      SpaceName:
        description: 'Space åç§°ï¼ˆé»˜è®¤ï¼šPlayerï¼‰'
        required: false
        default: 'Player'
      Private:
        description: 'æ˜¯å¦è®¾ä¸ºç§æœ‰ Spaceï¼ˆtrue/falseï¼‰'
        required: false
        default: 'false'

jobs:
  create-space:
    runs-on: ubuntu-latest

    steps:
      - name: âœ… å…‹éš† Player ä»“åº“
        run: |
          git clone https://github.com/zxlwq/Player.git
          ls Player

      - name: ğŸ§  å®‰è£… Python ä¸ Hugging Face SDK
        run: |
          python3 -m pip install --upgrade pip
          pip install huggingface_hub

      - name: ğŸ“¥ å†™å…¥ Python è„šæœ¬
        run: |
          cat <<EOF > create_space.py
from huggingface_hub import HfApi

import os

token = os.environ.get('HF_TOKEN')
user = os.environ.get('HF_USER')
space_name = os.environ.get('HF_SPACE') or 'Player'
private = os.environ.get('HF_PRIVATE', 'false').lower() == 'true'

repo_id = f"{user}/{space_name}"
api = HfApi()

try:
    api.create_repo(
        repo_id=repo_id,
        token=token,
        repo_type="space",
        space_sdk="static",
        private=private
    )
    print(f"âœ… æˆåŠŸåˆ›å»º Spaceï¼š{repo_id}")
except Exception as e:
    print(f"âš ï¸ Space åˆ›å»ºå¤±è´¥ï¼ˆå¯èƒ½å·²å­˜åœ¨ï¼‰ï¼š{e}")

try:
    api.upload_folder(
        folder_path="Player",
        repo_id=repo_id,
        repo_type="space",
        token=token
    )
    print("âœ… Player ä»£ç ä¸Šä¼ å®Œæˆã€‚")
except Exception as e:
    print(f"âŒ ä¸Šä¼ å¤±è´¥ï¼š{e}")
EOF

      - name: ğŸš€ æ‰§è¡Œ Python è„šæœ¬ä¸Šä¼  Space
        env:
          HF_TOKEN: ${{ github.event.inputs.Token }}
          HF_USER: ${{ github.event.inputs.UserID }}
          HF_SPACE: ${{ github.event.inputs.SpaceName }}
          HF_PRIVATE: ${{ github.event.inputs.Private }}
        run: python3 create_space.py
